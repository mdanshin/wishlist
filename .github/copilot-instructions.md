# Wishlist AI Guide
- **Коммуникация**: Отвечай пользователю строго на русском языке, включая ошибки и предупреждения.
- **Stack**: Static HTML (`index.html`) served with ES-module JavaScript (`src/app.js`); no bundler or framework in play.
- **Serving**: Run `npm install` once, then `npm start` to launch `live-server .`; browser reloads automatically. Static file preview without a server fails because of module imports.
- **Entry points**: `index.html` loads `src/app.js` via `<script type="module">`. Keep DOM IDs stable; UI wiring in `app.js` depends on them.
- **Auth data flow**: `app.js` triggers Google sign-in (`signInWithPopup`), listens to `onAuthStateChanged`, and toggles DOM sections instead of routing. Maintain that flow when adding features.
- **Firestore usage**: User metadata lives at `users/{uid}`. Wishlist items live under `users/{uid}/wishlist` with `{ text, createdAt }`. New features should respect this nesting to avoid breaking reads.
- **Date handling**: `createdAt` is stored as ISO strings generated by `new Date().toISOString()`. Stick with that format unless you update both read & render logic.
- **UI conventions**: Success paths silent, failures surface with `alert(...)` (currently Russian messages) and `console.error`. Match the tone/language for consistency.
- **State toggles**: Visibility switches happen via `element.style.display`. Prefer reusing that pattern instead of introducing new state managers.
- **Firebase module loading**: `src/firebase.js` exports `auth`, `provider`, `db`. The file currently mixes CDN imports with placeholder Node imports—choose one style per task (the app expects the CDN block) and avoid reintroducing dual initializations.
- **Config expectations**: `firebaseConfig` is committed with sample values. When documenting or scripting, point developers to replace it or externalize secrets; do not hard-code new secrets.
- **External deps**: Browser pulls Firebase 9.22.2 modules from `https://www.gstatic.com`. Any new Firebase APIs must be imported from that CDN with matching version.
- **DOM helpers**: Elements are cached once at the top of `app.js`. Continue that pattern for new controls to minimize repeated lookups.
- **List rendering**: `loadWishlist` rebuilds the list from scratch and renders simple `<li>` nodes. Keep rendering side effects confined to that function.
- **Logout flow**: `signOut` is the only logout path; ensure additional teardown logic hooks into the existing `onAuthStateChanged` branch rather than manual DOM resets.
- **Styling**: All styles live in `src/styles.css`; base CSS is minimal. Additions should stay lightweight or consider documenting the need for a styling framework.
- **Testing**: No automated tests. Manual verification is via live browser session; document reproducible steps when adding logic.
- **Common tasks**: For a new Firestore field, update both the `setDoc` payload and the read loop. For new user actions, bind events after DOM query at top of file.
- **Deployment**: Проект публикуется на GitHub Pages: рассчитывай только на статические файлы, используй относительные пути, не полагайся на серверные API и учитывай ограничения по env-переменным.
- **Версионность**: Повышай версию через `npm version <level>` — скрипт `sync-version` автоматически пропишет query-параметры `?v=...` в `index.html` и обновит `src/version.js`, чтобы браузер не кешировал старые сборки. После команды не забудь закоммитить изменённые файлы.
- **Pitfalls**: Duplicate `initializeApp` calls in `src/firebase.js` will break auth; remove unused blocks when adjusting the config. Missing Firebase config will throw at runtime—guard or document setup expectations.
- **When in doubt**: Compare against `src/app.js` for data flow and `index.html` for structure before introducing new components. Prefer incremental DOM updates over framework-level rewrites.
